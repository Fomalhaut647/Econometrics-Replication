# 表格9：就业变化的扩展模型

## 概述
此文件夹包含基于Card和Krueger (1994)表格4的扩展分析，呈现了三个不同规范的就业变化模型，用于探索最低工资政策效应的异质性和非线性特征。

## 文件
- `replicate.py`：复现表格计算的Python脚本
- `output.md`：从复现脚本生成的输出
- `README.md`：本文件

## 模型规范

### 模型设计思路
表格9基于表格4的模型(iv)进行扩展，探索两个重要的经济学问题：

1. **政策效应的异质性**：不同起薪水平的企业是否对最低工资政策有不同的反应？
2. **政策效应的非线性**：工资差距与就业变化之间是否存在非线性关系？

### 三个模型规范

#### 模型 (i)：基准模型
- **规范**：DEMP ~ GAP + 连锁店和所有权控制变量
- **说明**：与表格4的模型(iv)完全相同，作为对比基准
- **包含变量**：
  - 初始工资差距 (GAP)
  - 连锁店虚拟变量 (BK, KFC, ROYS)
  - 公司所有权虚拟变量 (CO_OWNED)

#### 模型 (ii)：异质性效应模型
- **规范**：基准模型 + 新泽西州$4.25起薪虚拟变量
- **新增变量**：NJ_WAGE425
  - 当wave1的起薪为$4.25且位于新泽西州时 = 1
  - 其他情况 = 0
- **经济学解释**：
  - 检验起薪恰好为最低工资标准的新泽西州企业是否有特殊的就业反应
  - 这些企业面临最直接的政策冲击

#### 模型 (iii)：非线性效应模型
- **规范**：基准模型 + GAP二次项
- **新增变量**：GAP_SQUARED = GAP²
- **经济学解释**：
  - 检验工资差距与就业变化的关系是否为非线性
  - 较大的工资差距可能产生递增或递减的边际效应

## 关键变量定义

### 新创建变量

#### NJ_WAGE425 (新泽西州$4.25起薪虚拟变量)
```python
df['nj_wage425'] = ((df['WAGE_ST'] == 4.25) & (df['STATE'] == 1)).astype(int)
```
- **定义**：新泽西州且wave1起薪为$4.25的店铺 = 1，否则 = 0
- **经济含义**：识别受最低工资政策直接影响的"边际"企业
- **预期效应**：这些企业的就业反应可能与其他企业不同

#### GAP_SQUARED (工资差距二次项)
```python
df['gap_squared'] = df['gap'] ** 2
```
- **定义**：初始工资差距的平方
- **经济含义**：捕捉工资差距对就业影响的非线性特征
- **预期效应**：如果存在规模经济或调整成本，可能观察到非线性效应

## 分析框架

### 统计比较指标
表格9报告以下统计量进行模型比较：

1. **R²**：模型拟合优度，衡量模型解释变异的比例
2. **回归标准误**：残差标准差，衡量预测精度
3. **控制变量F检验**：连锁店和所有权变量的联合显著性
4. **新增变量显著性**：模型(ii)和(iii)中新增变量的t检验

### 经济学解释框架

#### 异质性效应解释 (模型ii)
- **显著为正**：起薪$4.25的新泽西州企业就业增长更多
- **显著为负**：这些企业就业下降更多（可能因调整成本更高）
- **不显著**：政策效应在不同起薪水平间无异质性

#### 非线性效应解释 (模型iii)
- **GAP²系数显著为正**：边际效应递增（调整成本递增）
- **GAP²系数显著为负**：边际效应递减（规模经济）
- **GAP²系数不显著**：线性关系假设成立

## 实证策略

### 样本选择
- 使用与表格4相同的357家店铺样本
- 确保所有关键变量的数据完整性
- 保持与原研究的可比性

### 估计方法
- 普通最小二乘法 (OLS)
- 异方差稳健标准误
- 联合F检验用于控制变量显著性测试

### 模型比较策略
1. **嵌套模型比较**：通过R²和标准误比较拟合优度
2. **变量显著性**：评估新增变量的统计和经济显著性
3. **系数稳定性**：检查基础变量系数在不同规范下的稳定性

## 预期发现

### 可能的实证结果

#### 情形1：异质性效应存在
- 模型(ii)中NJ_WAGE425系数显著
- R²相比基准模型有所提升
- 表明政策效应在不同企业间存在差异

#### 情形2：非线性效应存在
- 模型(iii)中GAP_SQUARED系数显著
- 线性模型可能低估或高估政策效应
- 需要更复杂的政策分析框架

#### 情形3：线性同质性模型成立
- 新增变量均不显著
- 基准模型已充分捕捉政策效应
- 支持原研究的简单线性规范

## 政策含义

### 异质性效应的政策含义
如果发现显著的异质性效应：
- 最低工资政策需要考虑企业的初始工资水平
- 政策制定应区别对待不同类型的企业
- 可能需要渐进式或差别化的政策实施

### 非线性效应的政策含义
如果发现显著的非线性效应：
- 政策效应可能随工资差距大小而变化
- 需要更精细的政策工具和阈值设计
- 简单的线性预测可能产生误导

## 技术实现

### 关键函数

#### `create_additional_variables(df)`
创建表格9特有的变量：
- 新泽西州$4.25起薪虚拟变量
- GAP二次项变量

#### `run_regressions(df)`
运行三个回归模型：
- 基准模型（复制表格4模型iv）
- 异质性效应模型
- 非线性效应模型

#### `format_table(results, sample_size)`
格式化输出表格，包含：
- 系数和标准误
- R²和回归标准误
- F检验结果
- 变量显著性检验

## 运行方法

```bash
cd table_9
python replicate.py
```

## 依赖包
- pandas: 数据处理
- numpy: 数值计算  
- statsmodels: 回归分析
- scipy: 统计测试

## 使用注意事项

1. 确保 `../data/public.dat` 文件存在且格式正确
2. 脚本依赖 `../utility.py` 模块的函数
3. 输出为标准Markdown格式，便于文档集成
4. 所有统计量保留适当的小数位数以便对比

## 扩展可能性

基于表格9的结果，可以进一步探索：
1. **交互效应**：GAP与连锁店类型的交互
2. **分组回归**：按起薪水平分组的子样本分析
3. **稳健性检验**：不同函数形式的非线性规范
4. **机制检验**：探索异质性和非线性效应的经济机制